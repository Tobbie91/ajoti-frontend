import { Menu } from '@mantine/core'
import { NavLink as RouterNavLink } from 'react-router-dom'
import { IconBell, IconChevronDown } from '@tabler/icons-react'
import styles from './AppHeader.module.css'

type AppHeaderProps = {
  avatarSrc: string
  accountLabel?: string
}

type SvgProps = { className?: string }

function HomeIcon({ className }: SvgProps) {
  return (
    <svg
      className={className}
      width="22"
      height="25"
      viewBox="0 0 22 25"
      fill="none"
      xmlns="http://www.w3.org/2000/svg"
      aria-hidden="true"
    >
      <path
        d="M2.75 22H6.875V13.75H15.125V22H19.25V9.625L11 3.4375L2.75 9.625V22ZM0 24.75V8.25L11 0L22 8.25V24.75H12.375V16.5H9.625V24.75H0Z"
        fill="currentColor"
      />
    </svg>
  )
}

function SavingsIcon({ className }: SvgProps) {
  return (
    <svg
      className={className}
      width="26"
      height="25"
      viewBox="0 0 26 25"
      fill="none"
      xmlns="http://www.w3.org/2000/svg"
      aria-hidden="true"
    >
      <path
        d="M3.9 0C2.86566 0 1.87368 0.410892 1.14228 1.14228C0.410892 1.87368 0 2.86566 0 3.9V20.8C0 21.8343 0.410892 22.8263 1.14228 23.5577C1.87368 24.2891 2.86566 24.7 3.9 24.7H20.8C21.8343 24.7 22.8263 24.2891 23.5577 23.5577C24.2891 22.8263 24.7 21.8343 24.7 20.8V18.499C25.519 17.758 26 16.705 26 15.6V9.1C26 7.995 25.519 6.942 24.7 6.201V3.9C24.7 2.86566 24.2891 1.87368 23.5577 1.14228C22.8263 0.410892 21.8343 0 20.8 0H3.9ZM3.9 1.3H20.8C21.4896 1.3 22.1509 1.57393 22.6385 2.06152C23.1261 2.54912 23.4 3.21044 23.4 3.9V5.421C22.984 5.278 22.542 5.2 22.1 5.2H14.3C13.2657 5.2 12.2737 5.61089 11.5423 6.34228C10.8109 7.07368 10.4 8.06566 10.4 9.1V15.6C10.4 16.6343 10.8109 17.6263 11.5423 18.3577C12.2737 19.0891 13.2657 19.5 14.3 19.5H22.1C22.542 19.5 22.984 19.422 23.4 19.279V20.8C23.4 21.4896 23.1261 22.1509 22.6385 22.6385C22.1509 23.1261 21.4896 23.4 20.8 23.4H3.9C3.21044 23.4 2.54912 23.1261 2.06152 22.6385C1.57393 22.1509 1.3 21.4896 1.3 20.8V3.9C1.3 3.21044 1.57393 2.54912 2.06152 2.06152C2.54912 1.57393 3.21044 1.3 3.9 1.3ZM14.3 6.5H22.1C22.7896 6.5 23.4509 6.77393 23.9385 7.26152C24.4261 7.74912 24.7 8.41044 24.7 9.1V15.6C24.7 16.2896 24.4261 16.9509 23.9385 17.4385C23.4509 17.9261 22.7896 18.2 22.1 18.2H14.3C13.6104 18.2 12.9491 17.9261 12.4615 17.4385C11.9739 16.9509 11.7 16.2896 11.7 15.6V9.1C11.7 8.41044 11.9739 7.74912 12.4615 7.26152C12.9491 6.77393 13.6104 6.5 14.3 6.5ZM17.55 9.1C16.688 9.1 15.8614 9.44241 15.2519 10.0519C14.6424 10.6614 14.3 11.488 14.3 12.35C14.3 13.212 14.6424 14.0386 15.2519 14.6481C15.8614 15.2576 16.688 15.6 17.55 15.6C18.412 15.6 19.2386 15.2576 19.8481 14.6481C20.4576 14.0386 20.8 13.212 20.8 12.35C20.8 11.488 20.4576 10.6614 19.8481 10.0519C19.2386 9.44241 18.412 9.1 17.55 9.1ZM17.55 10.4C18.0672 10.4 18.5632 10.6054 18.9289 10.9711C19.2946 11.3368 19.5 11.8328 19.5 12.35C19.5 12.8672 19.2946 13.3632 18.9289 13.7289C18.5632 14.0946 18.0672 14.3 17.55 14.3C17.0328 14.3 16.5368 14.0946 16.1711 13.7289C15.8054 13.3632 15.6 12.8672 15.6 12.35C15.6 11.8328 15.8054 11.3368 16.1711 10.9711C16.5368 10.6054 17.0328 10.4 17.55 10.4Z"
        fill="currentColor"
      />
    </svg>
  )
}

function RoscaIcon({ className }: SvgProps) {
  return (
    <svg
      className={className}
      width="31"
      height="20"
      viewBox="0 0 31 20"
      fill="none"
      xmlns="http://www.w3.org/2000/svg"
      aria-hidden="true"
    >
      <path
        d="M20.9681 19.5703C20.3158 19.5703 19.6812 19.5064 19.0642 19.3788C18.4473 19.2511 17.8472 19.0703 17.2638 18.8364C18.6383 17.5783 19.7161 16.1748 20.4971 14.626C21.278 13.0771 21.668 11.4635 21.6671 9.78513C21.6661 8.10675 21.2761 6.49313 20.4971 4.94429C19.718 3.39544 18.6402 1.99197 17.2638 0.733885C17.8462 0.500906 18.4464 0.32058 19.0642 0.192907C19.6821 0.0652342 20.3167 0.000931917 20.9681 0C23.694 0 26.0066 0.949624 27.9058 2.84887C29.805 4.74812 30.7542 7.06021 30.7533 9.78513C30.7523 12.5101 29.8032 14.8226 27.9058 16.7228C26.0084 18.623 23.6959 19.5721 20.9681 19.5703ZM15.3766 17.8229C14.0953 16.9376 13.0762 15.796 12.3195 14.3981C11.5628 13.0002 11.1839 11.4626 11.183 9.78513C11.1821 8.10768 11.5609 6.57002 12.3195 5.17214C13.0781 3.77427 14.0971 2.63267 15.3766 1.74735C16.658 2.63267 17.6775 3.77427 18.4352 5.17214C19.1928 6.57002 19.5712 8.10768 19.5703 9.78513C19.5693 11.4626 19.191 13.0002 18.4352 14.3981C17.6794 15.796 16.6599 16.9376 15.3766 17.8229ZM9.78513 19.5703C7.05928 19.5703 4.74719 18.6211 2.84887 16.7228C0.950557 14.8245 0.000932603 12.5119 6.85233e-07 9.78513C-0.000931232 7.05834 0.948693 4.74626 2.84887 2.84887C4.74905 0.951488 7.06114 0.00186383 9.78513 0C10.4375 0 11.0726 0.0643023 11.6904 0.192907C12.3083 0.321512 12.908 0.501838 13.4895 0.733885C12.1149 1.99197 11.0376 3.39591 10.2576 4.94569C9.4776 6.49546 9.08713 8.10861 9.0862 9.78513C9.0862 11.6257 9.46502 13.3325 10.2227 14.9056C10.9803 16.4786 12.0227 17.8122 13.3497 18.9063C12.7906 19.116 12.2142 19.279 11.6205 19.3955C11.0269 19.512 10.4151 19.5703 9.78513 19.5703Z"
        fill="currentColor"
      />
    </svg>
  )
}

function InvestmentsIcon({ className }: SvgProps) {
  return (
    <svg
      className={className}
      width="25"
      height="26"
      viewBox="0 0 25 26"
      fill="none"
      xmlns="http://www.w3.org/2000/svg"
      aria-hidden="true"
    >
      <path
        d="M18.2 2.6C17.8552 2.6 17.5246 2.46304 17.2808 2.21924C17.037 1.97544 16.9 1.64478 16.9 1.3C16.9 0.955218 17.037 0.624558 17.2808 0.380761C17.5246 0.136964 17.8552 0 18.2 0H23.4C23.7448 0 24.0754 0.136964 24.3192 0.380761C24.563 0.624558 24.7 0.955218 24.7 1.3V6.5C24.7 6.84478 24.563 7.17544 24.3192 7.41924C24.0754 7.66304 23.7448 7.8 23.4 7.8C23.0552 7.8 22.7246 7.66304 22.4808 7.41924C22.237 7.17544 22.1 6.84478 22.1 6.5V4.4382L14.5691 11.9691C14.3253 12.2128 13.9947 12.3497 13.65 12.3497C13.3053 12.3497 12.9747 12.2128 12.7309 11.9691L9.1 8.3382L2.2191 15.2191C1.97392 15.4559 1.64553 15.5869 1.30468 15.584C0.963823 15.581 0.637767 15.4443 0.396736 15.2033C0.155705 14.9622 0.0189857 14.6362 0.0160238 14.2953C0.0130619 13.9545 0.144094 13.6261 0.3809 13.3809L8.1809 5.5809C8.42469 5.33719 8.75529 5.20028 9.1 5.20028C9.44471 5.20028 9.77531 5.33719 10.0191 5.5809L13.65 9.2118L20.2618 2.6H18.2ZM2.6 20.8V24.7C2.6 25.0448 2.46304 25.3754 2.21924 25.6192C1.97544 25.863 1.64478 26 1.3 26C0.955219 26 0.624558 25.863 0.380761 25.6192C0.136964 25.3754 0 25.0448 0 24.7V20.8C0 20.4552 0.136964 20.1246 0.380761 19.8808C0.624558 19.637 0.955219 19.5 1.3 19.5C1.64478 19.5 1.97544 19.637 2.21924 19.8808C2.46304 20.1246 2.6 20.4552 2.6 20.8ZM9.1 15.6C9.1 15.2552 8.96304 14.9246 8.71924 14.6808C8.47544 14.437 8.14478 14.3 7.8 14.3C7.45522 14.3 7.12456 14.437 6.88076 14.6808C6.63696 14.9246 6.5 15.2552 6.5 15.6V24.7C6.5 25.0448 6.63696 25.3754 6.88076 25.6192C7.12456 25.863 7.45522 26 7.8 26C8.14478 26 8.47544 25.863 8.71924 25.6192C8.96304 25.3754 9.1 25.0448 9.1 24.7V15.6ZM14.3 16.9C14.6448 16.9 14.9754 17.037 15.2192 17.2808C15.463 17.5246 15.6 17.8552 15.6 18.2V24.7C15.6 25.0448 15.463 25.3754 15.2192 25.6192C14.9754 25.863 14.6448 26 14.3 26C13.9552 26 13.6246 25.863 13.3808 25.6192C13.137 25.3754 13 25.0448 13 24.7V18.2C13 17.8552 13.137 17.5246 13.3808 17.2808C13.6246 17.037 13.9552 16.9 14.3 16.9ZM22.1 11.7C22.1 11.3552 21.963 11.0246 21.7192 10.7808C21.4754 10.537 21.1448 10.4 20.8 10.4C20.4552 10.4 20.1246 10.537 19.8808 10.7808C19.637 11.0246 19.5 11.3552 19.5 11.7V24.7C19.5 25.0448 19.637 25.3754 19.8808 25.6192C20.1246 25.863 20.4552 26 20.8 26C21.1448 26 21.4754 25.863 21.7192 25.6192C21.963 25.3754 22.1 25.0448 22.1 24.7V11.7Z"
        fill="currentColor"
      />
    </svg>
  )
}

function cx(...classes: Array<string | false | undefined>) {
  return classes.filter(Boolean).join(' ')
}

export function AppHeader({ avatarSrc, accountLabel = 'My account' }: AppHeaderProps) {
  return (
    <header className={styles.header}>
      {/* Logo */}
      <div className={styles.logo}>AJOTI</div>

      {/* Nav */}
      <nav className={styles.nav}>
        <RouterNavLink
          to="/"
          end
          className={({ isActive }) => cx(styles.navItem, isActive ? styles.active : styles.inactive)}
        >
          <HomeIcon className={styles.navIconHome} />
          <span className={styles.navLabel}>Home</span>
        </RouterNavLink>

        {/* Savings dropdown */}
        <Menu withinPortal position="bottom-start" offset={10}>
          <Menu.Target>
            <button type="button" className={cx(styles.navItem, styles.inactive, styles.navButton)}>
              <SavingsIcon className={styles.navIcon} />
              <span className={styles.navLabel}>Savings</span>
              <IconChevronDown className={styles.chevron} />
            </button>
          </Menu.Target>

          <Menu.Dropdown>
            <Menu.Item>Fixed Savings</Menu.Item>
            <Menu.Item>Target Savings</Menu.Item>
          </Menu.Dropdown>
        </Menu>

        <RouterNavLink to="/rosca" className={() => cx(styles.navItem, styles.inactive)}>
          <RoscaIcon className={styles.navIconRosca} />
          <span className={styles.navLabel}>ROSCA</span>
        </RouterNavLink>

        <RouterNavLink to="/investments" className={() => cx(styles.navItem, styles.inactive)}>
          <InvestmentsIcon className={styles.navIconInvest} />
          <span className={styles.navLabel}>Investments</span>
        </RouterNavLink>
      </nav>

      {/* Right side (bell + account) */}
      <div className={styles.right}>
        <div className={styles.bellWrap}>
          <IconBell className={styles.bellIcon} />
        </div>

        <div className={styles.account}>
          <div className={styles.avatarRing}>
            <img className={styles.avatarImg} src={avatarSrc} alt="" />
          </div>
          <span className={styles.accountText}>{accountLabel}</span>
        </div>
      </div>
    </header>
  )
}

